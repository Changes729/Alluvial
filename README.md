# Alluvial

## 数据存储设计

考虑到后续版本更新，多媒体数据的保存需要有一定的机制，以保证**非应用软件系统独占**。

> 非应用软件系统独占意味着数据是基于操作系统的开放。对基于操作系统的开放有几点认识细节：
>
> - 操作系统并不是完全开放的，我们都知道，操作系统事实上是有用户，有权限管理的。为了防止计算机成为肉机，也为了保证数据安全，因此，操作系统上的数据通常都有对应的操作权限。所以数据是安全的。
> - 另一方面，几乎所有的应用软件都是允许在一个电脑上（本地操作系统），虽然当下和未来，分布式系统、云计算等新计算平台等出现在冲击本地操作系统，但是作为人进入互联网的第一终端，个人机一定会继续存在，基于单操作系统的开放意味着个人设备的数据，对于个人用户是完全开放的。
>
> 基于这一点，我们就可以对我们的数据进行安全性管理，对我们的数据在安全的基础上，可以尽可能的让「自己」享受自己的数据。

最便携的数据存储就是文件夹。这是操作系统支持的大文件管理方案。它支持具名的访问，同时也支持软连接等非数据拷贝的引用，能记录文件更新时间等。但其也存在一些问题——同一个文件夹下的文件不能同名。

因此，当前的**数据计划以天为单位的文件夹进行管理。一天内，同名的文件会被覆盖，但是多天间同名的文件不会被覆盖。**

> 这样设计的好处在于，数据可以方便的使用操作系统和脚本进行管理。数据和应用软件解耦。
>
> 另一方面，对于后期迭代，如果觉得以天为单位不可行，则可以进一步提高时间颗粒度。

> 或者其实还有方案2，数据不是以天为单位在文件夹进行管理，而是通过文件重命名的方式进行软覆盖。比如我要存储一个`杭州游玩.jpg` 的图片。那这个时候，后台会有一个 `杭州游玩.jpg` 的文件，如果这个时候存储了第二张`杭州游玩.jpg` ，用户应该明确这张图片是上一张图片的替代，还是不同图片的梗概。
>
> - 如果是梗概，我们更推荐用不同名字，用「1、2」区分出图片，然后为他们打上同样的标签——杭州游玩。
> - 如果是同一张图片的不同版本，那么后台会通过重新命名来区分图片，会把新的变成 `.杭州游玩.0.jpg` ，使用一个引用指向具体的文件。
>   - 一方面，系统需要禁止隐藏文件上传
>   - 另一方面，本地隐藏文件也会对非应用软件访问提供便利

> 我感觉是不是直接用 Git 会方便很多？
>
> 还是以后再修改协议栈吧。